<!-- src/templates/builds/list.html -->
{% extends "base.html" %}

{% block title %}–í—Å–µ –±–∏–ª–¥—ã{% endblock %}

{% block content %}
<div class="container mt-4">
  <!-- üîç –§–û–†–ú–ê –ü–û–ò–°–ö–ê -->
  <form method="get" class="mb-4">
    <div class="input-group">
      <input
        type="text"
        name="q"
        class="form-control bg-dark text-light border-orange"
        placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –±–∏–ª–¥–∞..."
        value="{{ request.args.get('q', '') }}"
      >
      <button class="btn btn-orange" type="submit">–ù–∞–π—Ç–∏</button>
    </div>
  </form>

  <h2 class="text-light mb-4">
    {% if request.args.get('q') %}
      –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞: "{{ request.args.get('q') }}"
    {% else %}
      –í—Å–µ –±–∏–ª–¥—ã
    {% endif %}
  </h2>

  {% if builds.items %}
    <div class="row">
      {% for build in builds.items %}
        <div class="col-md-4 mb-3">
          <div class="card bg-dark text-light h-100">
            <img src="/static/img/weapons/{{ build.weapon.name_eng }}.png"
                 class="card-img-top" alt="{{ build.weapon.name_ru }}" style="max-height: 150px; object-fit: cover;">
            <div class="card-body">
              <h5 class="card-title">{{ build.title }}</h5>
              <p class="card-text text-muted">{{ build.weapon.name_ru }}</p>
              <p class="card-text"><small class="text-muted">–ê–≤—Ç–æ—Ä: {{ build.author.username }}</small></p>
              <a href="{{ url_for('builds.view_build', build_id=build.id) }}" class="btn btn-outline-orange btn-sm">–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å</a>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>

    {% if builds.pages > 1 %}
      <nav aria-label="Page navigation" class="mt-4">
        <ul class="pagination justify-content-center">
          {% if builds.has_prev %}
            <li class="page-item">
              <a class="page-link" href="{{ url_for('builds.list_builds', q=request.args.get('q'), page=builds.prev_num) }}">¬´</a>
            </li>
          {% endif %}

          {% for page in builds.iter_pages() %}
            {% if page %}
              {% if page != builds.page %}
                <li class="page-item">
                  <a class="page-link" href="{{ url_for('builds.list_builds', q=request.args.get('q'), page=page) }}">{{ page }}</a>
                </li>
              {% else %}
                <li class="page-item active">
                  <span class="page-link">{{ page }}</span>
                </li>
              {% endif %}
            {% endif %}
          {% endfor %}

          {% if builds.has_next %}
            <li class="page-item">
              <a class="page-link" href="{{ url_for('builds.list_builds', q=request.args.get('q'), page=builds.next_num) }}">¬ª</a>
            </li>
          {% endif %}
        </ul>
      </nav>
    {% endif %}
  {% else %}
    <div class="alert alert-info">
      {% if request.args.get('q') %}
        –ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –ø–æ –∑–∞–ø—Ä–æ—Å—É "{{ request.args.get('q') }}".
      {% else %}
        –ü–æ–∫–∞ –Ω–µ—Ç –Ω–∏ –æ–¥–Ω–æ–≥–æ –±–∏–ª–¥–∞.
      {% endif %}
    </div>
  {% endif %}
</div>
{% endblock %}